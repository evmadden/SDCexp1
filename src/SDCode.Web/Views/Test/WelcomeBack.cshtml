@model SDCode.Web.Models.TestWelcomeBackViewModel
@using SDCode.Web.Classes;
@{
    ViewData["Title"] = "Welcome Back";
}

@if (Model.Action == TestWelcomeBackAction.NewUser) {
    <div>
        It looks like you are a New User.  Please return to the home page to select "New Participant."
        If you feel you have reached this page by mistake, please email the researcher at <a href="mailto:evm517@york.ac.uk">evm517@york.ac.uk</a>.
    </div>
    <form action="@Url.Action("Welcome", "Home")" method="POST">
        <input type="hidden" name="participantID" value="@Model.ParticipantID" />
        <div style="text-align: right;">
            <input style="margin-right: 50px;" type="submit" value="New Participant"/>
        </div>
    </form>
} else if (Model.Action == TestWelcomeBackAction.Wait) {
    <div>
        It looks like you are trying to access the study outside of testing hours.  See below for your next session time.
        If you feel you have reached this page by mistake, please email the researcher at evm517@york.ac.uk
    </div>
    <div>
        @{
            var whenToDisplay = @Model.NextTestWhenUtc?.AddMinutes(1);
        }
        Test available at: @whenToDisplay?.ToString("MM/dd/yyyy") @whenToDisplay?.ToString("h:mm tt") UTC
    </div>
} else if (Model.Action == TestWelcomeBackAction.Done) {
    <span>You have completed the experiment.  Thank you for participating in our study.</span>
} else {
    if (Model.Action == TestWelcomeBackAction.Stanford) {
        @await Html.PartialAsync("~/Views/Home/LogoBanner.cshtml")
        @await Html.PartialAsync("~/Views/ImageCheck/StanfordForm.cshtml", new StanfordFormViewModel(Model.ParticipantID, Url.Action("Index")))
    } else {
        <form action="@Url.Action("Index", "ImageCheck")" method="POST">
            <input type="hidden" name="nextActionAfterImageCheck" value="@Url.Action("Index")" />
            <input type="hidden" name="participantID" value="@Model.ParticipantID" />
        </form>
        <script>
            document.getElementsByTagName('form')[0].submit();
        </script>
    }                                                                
}